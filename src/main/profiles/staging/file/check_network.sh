#!/bin/bash

CHECK_DATA=(
[0]=172.21.182.14:6379 [1]=172.21.182.15:6379
[2]=172.21.179.45:2181 [3]=172.21.179.46:2181 [4]=172.21.179.47:2181 [5]=172.21.179.48:2181 [6]=172.21.179.49:2181
[7]=172.21.182.14:9092 [8]=172.21.182.15:9092 [9]=172.21.182.16:9092 [10]=172.21.182.17:9092 [11]=172.21.182.18:9092 [12]=172.21.182.19:9092 [13]=172.21.182.20:9092 [14]=172.21.182.21:9092 [15]=172.21.182.22:9092 [16]=172.21.182.23:9092
[17]=172.21.182.15:2181 [18]=172.21.182.16:2181 [19]=172.21.182.17:2181 [20]=172.21.182.18:2181 [21]=172.21.182.19:2181
[22]=172.21.179.44:60020 [23]=172.21.179.45:60020 [24]=172.21.179.46:60020 [25]=172.21.179.47:60020 [26]=172.21.179.48:60020 [27]=172.21.179.49:60020 [28]=172.21.179.50:60020
[29]=172.21.179.42:60000 [30]=172.21.179.43:60000
)

tpipe() {
  sleep 1;echo ''
  sleep 1;echo ''
}

CHECK_CNT=${#CHECK_DATA[@]}

i=0
while [ "$i" -lt "$CHECK_CNT" ]
do
  IP=`echo ${CHECK_DATA[$i]} | awk -F\: '{print $1}'`
  PT=`echo ${CHECK_DATA[$i]} | awk -F\: '{print $2}'`
  echo "####### CHECK : ${IP}:${PT}#######"

  tpipe | telnet ${IP} ${PT} 
  wait

  echo ""
  let "i = i + 1"
done
